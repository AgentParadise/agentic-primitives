id: file-security
kind: hook
category: "Read|Write|Edit|Delete"  # Matches file operation tools

# Specialized hook - only fires for file operations
events:
  - PreToolUse

summary: "Security validator for file operations - protects sensitive files, validates paths, enforces access policies, and prevents dangerous file modifications"

description: |
  Specialized security hook that validates file operations before execution.
  
  Features:
  - Protects sensitive files (.env, credentials, keys, etc.)
  - Validates file paths and prevents path traversal
  - Enforces access policies for different file types
  - Blocks operations on system files
  - Detects suspicious file patterns
  - Fast path validation (< 50ms typical)
  
  Use Cases:
  - Prevent credential exposure
  - Protect configuration files
  - Block system file modifications
  - Enforce file access policies
  - Audit sensitive file access

execution:
  strategy: pipeline
  timeout_sec: 5
  fail_on_error: true  # Block on validation failure

default_decision: "allow"

providers:
  claude:
    impl_file: "file-security.py"

metadata:
  version: "1.0.0"
  category: security
  priority: high
  blocking: true
  tags:
    - security
    - files
    - validation
    - access-control

