id: analytics-collector
kind: hook
category: analytics
events:
  - PreToolUse
  - PostToolUse
  - UserPromptSubmit
  - Stop
  - SubagentStop
  - SessionStart
  - SessionEnd
  - PreCompact
  - Notification
summary: "Universal analytics collector for all hook events - collects and normalizes analytics events from AI agent interactions, publishing them to configured backends (file or API) for monitoring and analysis"

execution:
  strategy: parallel
  timeout_sec: 5
  fail_on_error: false

middleware:
  - id: "event-normalizer"
    path: "../../../../../services/analytics/middleware/event_normalizer.py"
    type: analytics
    enabled: true
    priority: 10
    config:
      provider: "claude"
      debug: false
  
  - id: "event-publisher"
    path: "../../../../../services/analytics/middleware/event_publisher.py"
    type: analytics
    enabled: true
    priority: 20
    config:
      backend: "file"
      output_path: "./analytics/events.jsonl"

default_decision: "allow"

providers:
  claude:
    impl_file: "analytics-collector.py"

metrics:
  enabled: true
  backend: "none"
  tags:
    hook: "analytics-collector"
    category: "analytics"

logging:
  enabled: true
  level: "info"
  output: "logs/analytics-collector.jsonl"
  format: "json"

