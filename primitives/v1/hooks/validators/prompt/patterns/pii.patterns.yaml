# PII (Personally Identifiable Information) Patterns
# Used by pii.py validator to detect sensitive personal data
name: PII Detection Patterns
description: Patterns for detecting personally identifiable information in prompts

pii_patterns:
  # SSN (US Social Security Number)
  - id: ssn-formatted
    pattern: '\b\d{3}-\d{2}-\d{4}\b'
    description: "SSN"
    risk_level: high
    test_cases:
      - input: "My SSN is 123-45-6789"
        expected: blocked
      - input: "Call 123-456-7890"
        expected: allowed

  - id: ssn-unformatted
    pattern: '\b\d{9}\b'
    description: "potential SSN (9 digits)"
    risk_level: medium
    test_cases:
      - input: "SSN: 123456789"
        expected: suspicious

  # Credit card numbers
  - id: visa-formatted
    pattern: '\b4[0-9]{3}[-\s]?[0-9]{4}[-\s]?[0-9]{4}[-\s]?[0-9]{1,4}\b'
    description: "Visa card"
    risk_level: high
    test_cases:
      - input: "4111-1111-1111-1111"
        expected: blocked
      - input: "4111 1111 1111 1111"
        expected: blocked

  - id: visa-unformatted
    pattern: '\b4[0-9]{12}(?:[0-9]{3})?\b'
    description: "Visa card"
    risk_level: high
    test_cases:
      - input: "4111111111111111"
        expected: blocked

  - id: mastercard-formatted
    pattern: '\b5[1-5][0-9]{2}[-\s]?[0-9]{4}[-\s]?[0-9]{4}[-\s]?[0-9]{4}\b'
    description: "Mastercard"
    risk_level: high
    test_cases:
      - input: "5500-0000-0000-0004"
        expected: blocked

  - id: mastercard-unformatted
    pattern: '\b5[1-5][0-9]{14}\b'
    description: "Mastercard"
    risk_level: high
    test_cases:
      - input: "5500000000000004"
        expected: blocked

  - id: amex-formatted
    pattern: '\b3[47][0-9]{2}[-\s]?[0-9]{6}[-\s]?[0-9]{5}\b'
    description: "Amex card"
    risk_level: high
    test_cases:
      - input: "3400-000000-00009"
        expected: blocked

  - id: amex-unformatted
    pattern: '\b3[47][0-9]{13}\b'
    description: "Amex card"
    risk_level: high
    test_cases:
      - input: "340000000000009"
        expected: blocked

  - id: discover-formatted
    pattern: '\b6(?:011|5[0-9]{2})[-\s]?[0-9]{4}[-\s]?[0-9]{4}[-\s]?[0-9]{4}\b'
    description: "Discover card"
    risk_level: high

  - id: discover-unformatted
    pattern: '\b6(?:011|5[0-9]{2})[0-9]{12}\b'
    description: "Discover card"
    risk_level: high

  # Phone numbers
  - id: us-phone
    pattern: '\b(?:\+1[-.\s]?)?\(?[2-9]\d{2}\)?[-.\s]?\d{3}[-.\s]?\d{4}\b'
    description: "US phone number"
    risk_level: medium
    test_cases:
      - input: "(555) 123-4567"
        expected: suspicious
      - input: "+1-555-123-4567"
        expected: suspicious

  - id: intl-phone
    pattern: '\b\+\d{1,3}[-.\s]?\d{1,4}[-.\s]?\d{1,4}[-.\s]?\d{1,9}\b'
    description: "international phone"
    risk_level: medium
    test_cases:
      - input: "+44 20 7946 0958"
        expected: suspicious

  # Email addresses
  - id: email
    pattern: '\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b'
    description: "email address"
    risk_level: low
    test_cases:
      - input: "user@example.com"
        expected: suspicious

  # IP addresses
  - id: ip-address
    pattern: '\b(?:\d{1,3}\.){3}\d{1,3}\b'
    description: "IP address"
    risk_level: low
    test_cases:
      - input: "192.168.1.1"
        expected: suspicious

  # Dates of birth
  - id: date-mdy
    pattern: '\b(?:0?[1-9]|1[0-2])[/-](?:0?[1-9]|[12]\d|3[01])[/-](?:19|20)\d{2}\b'
    description: "date (MM/DD/YYYY)"
    risk_level: low
    test_cases:
      - input: "01/15/1990"
        expected: suspicious
      - input: "12-25-2000"
        expected: suspicious

  - id: date-ymd
    pattern: '\b(?:19|20)\d{2}[/-](?:0?[1-9]|1[0-2])[/-](?:0?[1-9]|[12]\d|3[01])\b'
    description: "date (YYYY-MM-DD)"
    risk_level: low
    test_cases:
      - input: "1990-01-15"
        expected: suspicious

  # Passport numbers
  - id: passport
    pattern: '\b[A-Z]{1,2}\d{6,9}\b'
    description: "potential passport number"
    risk_level: medium

  # Driver's license
  - id: drivers-license
    pattern: '\b[A-Z]\d{7,8}\b'
    description: "potential DL number"
    risk_level: low

context_patterns:
  # Patterns that indicate personal context but aren't PII themselves
  - id: ssn-context
    pattern: '\bmy\s+(?:ssn|social\s+security)'
    description: "SSN context"
    risk_level: medium

  - id: credit-card-context
    pattern: '\bmy\s+(?:credit\s+card|cc\s+number)'
    description: "credit card context"
    risk_level: medium

  - id: phone-context
    pattern: '\bmy\s+(?:phone|cell|mobile)\s+(?:number|#)'
    description: "phone context"
    risk_level: low

  - id: address-context
    pattern: '\bmy\s+(?:address|home\s+address)'
    description: "address context"
    risk_level: low

  - id: password-context
    pattern: '\bmy\s+(?:password|passwd|pwd)'
    description: "password context"
    risk_level: high

  - id: banking-context
    pattern: '\bmy\s+(?:bank\s+account|routing\s+number)'
    description: "banking context"
    risk_level: high
