---
title: Create a Command
description: Build a code review command with actionable feedback
---

import { Accordions, Accordion } from 'fumadocs-ui/components/accordion';
import { Cards, Card } from 'fumadocs-ui/components/card';
import { Callout } from 'fumadocs-ui/components/callout';

## What You'll Build

In this guide, you'll create a **Code Review Command** ‚Äî a task-specific action that performs comprehensive code reviews with actionable feedback.

<Callout type="info">
**Time:** ~10 minutes
**Prerequisites:** agentic-p installed, repository initialized
</Callout>

## What Are Commands?

Commands are **task-specific actions** that users invoke directly. Unlike agents (persistent personas), commands are:

- **One-shot**: Perform a single task and complete
- **Invokable**: Users call them directly with `/command-name`
- **Focused**: Do one thing well

## Step 1: Create the Command

```bash
agentic-p new command qa/review -d "Comprehensive code review with actionable feedback"
```

This creates:
```
primitives/v1/commands/qa/review/
‚îú‚îÄ‚îÄ review.meta.yaml
‚îî‚îÄ‚îÄ review.v1.md
```

## Step 2: Configure Metadata

Edit `review.meta.yaml`:

```yaml
spec_version: "v1"
type: command
name: review
description: "Comprehensive code review with actionable feedback"

versions:
  - version: 1
    status: active
    hash: blake3:pending
    created: "2025-12-09"
    notes: "Initial version - core review functionality"

default_version: 1

model:
  provider: anthropic
  name: claude-4-sonnet

# Command invocation
invocation: "/review"

# Expected inputs
inputs:
  - name: code
    description: "Code to review (file path or content)"
    required: true
  - name: focus
    description: "Review focus: security, performance, style, all"
    required: false
    default: "all"

categories:
  - qa
  - code-quality
```

## Step 3: Write the Command Prompt

Edit `review.v1.md`:

````markdown
# Code Review Command

You are performing a comprehensive code review. Your goal is to provide actionable, constructive feedback that improves code quality.

## Review Process

1. **Understand Context**: What does this code do? What problem does it solve?
2. **Assess Structure**: Is the code well-organized? Are responsibilities clear?
3. **Check Correctness**: Are there bugs, edge cases, or logic errors?
4. **Evaluate Quality**: Does it follow best practices and conventions?
5. **Consider Security**: Are there security vulnerabilities?
6. **Review Performance**: Are there obvious performance issues?

## Output Format

Structure your review as follows:

### Summary
A 2-3 sentence overview of the code and your overall assessment.

### Critical Issues üî¥
Issues that MUST be fixed before merging:
- Security vulnerabilities
- Bugs that cause incorrect behavior
- Data loss risks

### Improvements üü°
Issues that SHOULD be addressed:
- Code smell / maintainability issues
- Missing error handling
- Performance concerns

### Suggestions üü¢
Optional enhancements:
- Style improvements
- Alternative approaches
- Documentation gaps

### Specific Feedback
For each issue:
```
üìç Location: [file:line or description]
üîç Issue: [What's wrong]
üí° Suggestion: [How to fix it]
```

## Review Guidelines

### Security Review
- [ ] Input validation and sanitization
- [ ] Authentication/authorization checks
- [ ] Sensitive data handling (no hardcoded secrets)
- [ ] SQL injection / XSS / CSRF protection
- [ ] Secure communication (HTTPS, encryption)

### Performance Review
- [ ] N+1 query problems
- [ ] Unnecessary computations in loops
- [ ] Memory leaks / resource cleanup
- [ ] Appropriate data structures
- [ ] Caching opportunities

### Code Quality Review
- [ ] Clear naming conventions
- [ ] Appropriate abstractions
- [ ] DRY principle adherence
- [ ] Single responsibility principle
- [ ] Error handling completeness
- [ ] Test coverage

### Style Review
- [ ] Consistent formatting
- [ ] Meaningful comments
- [ ] Documentation completeness
- [ ] Type hints (for Python/TypeScript)

## Tone Guidelines

- Be constructive, not critical
- Explain WHY something is an issue
- Provide specific, actionable fixes
- Acknowledge good practices
- Ask clarifying questions when needed

## Example Review

### Summary
This authentication module handles user login and session management. The core logic is sound, but there are security concerns with password handling and missing input validation.

### Critical Issues üî¥

üìç Location: `auth.py:45`
üîç Issue: Password stored in plain text in logs
üí° Suggestion: Remove password from log statement or mask it:
```python
# Before
logger.info(f"Login attempt: {username}, {password}")

# After
logger.info(f"Login attempt: {username}")
```

### Improvements üü°

üìç Location: `auth.py:23-30`
üîç Issue: No rate limiting on login attempts
üí° Suggestion: Add rate limiting to prevent brute force attacks:
```python
from ratelimit import limits

@limits(calls=5, period=60)
def login(username: str, password: str) -> User:
    ...
```

### Suggestions üü¢

üìç Location: `auth.py:12`
üîç Issue: Magic number for session timeout
üí° Suggestion: Extract to named constant:
```python
SESSION_TIMEOUT_SECONDS = 3600  # 1 hour
```

### What's Done Well ‚ú®
- Clean separation of authentication and authorization
- Good use of context managers for database connections
- Comprehensive docstrings
````

## Step 4: Validate and Build

```bash
# Validate
agentic-p validate

# Build
agentic-p build --provider claude

# Install
agentic-p install --provider claude --project
```

## Step 5: Use Your Command

Invoke the command with Claude:

```
/review Please review this authentication module for security issues:

def login(username, password):
    user = db.query(f"SELECT * FROM users WHERE name='{username}'")
    if user and user.password == password:
        return create_session(user)
    return None
```

## Creating Specialized Review Commands

You can create focused review commands:

```bash
# Security-focused review
agentic-p new command qa/security-review

# Performance audit
agentic-p new command qa/perf-audit

# API review
agentic-p new command qa/api-review
```

## Best Practices

<Accordions>
  <Accordion title="Be specific about output format">
    Define exactly how you want the review structured. Consistent format makes reviews easier to act on.
  </Accordion>
  <Accordion title="Include checklists">
    Checklists help ensure comprehensive reviews and remind the agent what to check.
  </Accordion>
  <Accordion title="Set the right tone">
    Code review can be sensitive. Define tone guidelines for constructive feedback.
  </Accordion>
  <Accordion title="Provide examples">
    Example output helps the agent understand your expectations.
  </Accordion>
</Accordions>

## Next Steps

<Cards>
  <Card
    title="Create a Tool"
    href="/docs/guides/create-tool"
  >
    Integrate external systems
  </Card>
  <Card
    title="Create a Hook"
    href="/docs/guides/create-hook"
  >
    Add safety middleware
  </Card>
</Cards>
